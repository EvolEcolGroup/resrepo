<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data versioning • resrepo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data versioning">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">resrepo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/resrepo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_versioning.html">Data versioning</a></li>
    <li><a class="dropdown-item" href="../articles/sharing_resrepo.html">Sharing a resrepo repository</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data versioning</h1>
            
      

      <div class="d-none name"><code>data_versioning.Rmd</code></div>
    </div>

    
    
<p>This vignette will cover the data versioning functionality of the
<code>resrepo</code> package, considering the following use cases:</p>
<ul>
<li>Your data are too large to be stored in a git repository</li>
<li>You want to explore alternative workflows for your data
analysis</li>
<li>You want to store your data externally</li>
</ul>
<p>The function <code>version_setup</code> is used in each of these
cases to create a versioned repository to work with. We begin in this
way to maintain consistent structure of <code>resrepo</code>
repositories.</p>
<ul>
<li><p>‘Setting up data versioning’ illustrates how to use the function
<code>version_setup</code> to create a versioned repository. This will
prevent git from tracking data.</p></li>
<li><p>‘Adding a new version’ will show you how to explore alternative
approaches to data analysis (e.g. a different version of data
filtering). This section illustrates how to add new versions of the code
and data, and merge branches.</p></li>
<li><p>‘Outsourcing the data’ demonstrates show how to use
<code>version_setup</code> to outsource your data storage to a different
location, such as a folder synced to the cloud or a hard drive. You can
still add new versions and merge branches when outsourcing your
data.</p></li>
</ul>
<div class="section level2">
<h2 id="setting-up-data-versioning">Setting up data versioning<a class="anchor" aria-label="anchor" href="#setting-up-data-versioning"></a>
</h2>
<p>Let us start by recreating the example repository. This is the same
repository we created in vignette <code>workflow</code>; if you still
have that repository, you don’t need to run the code below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://evolecolgroup.github.io/resrepo/">resrepo</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/init_resrepo.html">init_resrepo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/tux_measurements.csv"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/data/raw/original/tux_measurements.csv"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/s01_download_penguins.Rmd"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s01_download_penguins.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s01_download_penguins.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s01_download_penguins.Rmd</span></span>
<span><span class="co">#&gt; output file: s01_download_penguins.knit.md</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s01_download_penguins.pdf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/s02_merge_clean.Rmd"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s02_merge_clean.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s02_merge_clean.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s02_merge_clean.Rmd</span></span>
<span><span class="co">#&gt; output file: s02_merge_clean.knit.md</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s02_merge_clean.pdf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/s03_pca.Rmd"</span>, package <span class="op">=</span> <span class="st">"resrepo"</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s03_pca.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s03_pca.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s03_pca.Rmd</span></span>
<span><span class="co">#&gt; output file: s03_pca.knit.md</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s03_pca.pdf</span></span>
<span><span class="fu">git2r</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/git2r/reference/add.html" class="external-link">add</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu">git2r</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/git2r/reference/commit.html" class="external-link">commit</a></span><span class="op">(</span>message <span class="op">=</span> <span class="st">"Set up"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Let us check that we do have indeed a full repository:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s01_download_penguins.Rmd</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s02_merge_clean.Rmd</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #00BB00;">s03_pca.Rmd</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │       ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │       ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   │       └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── <span style="color: #0000BB; font-weight: bold;">original</span></span></span>
<span><span class="co">#&gt; │       │   └── tux_measurements.csv</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │           ├── palmer_penguins.csv</span></span>
<span><span class="co">#&gt; │           └── renv_s01_download_penguins.json</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">s03_pca</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── s03_pca.pdf</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s03_pca_files</span></span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">figure-latex</span></span></span>
<span><span class="co">#&gt; │               └── <span style="color: #BB00BB; font-weight: bold;">pca_plot-1.png</span></span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>When we want to start versioning the data, we can use the function
<code>version_setup</code>. We only need to use the function once at the
beginning of the project to initialise versioning. You can specify the
location of your data using the <code>resources_path</code> argument.
The function will create a subfolder named <code>versions</code> in this
location.</p>
<p>By default, this will be stored in your repository, but it doesn’t
have to, and it can be located anywhere on your system (see the second
part of this vignette for an example).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/version_setup.html">version_setup</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span>, resources_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Let us check what happened:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s01_download_penguins.Rmd</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s02_merge_clean.Rmd</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #00BB00;">s03_pca.Rmd</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">version_meta</span></span></span>
<span><span class="co">#&gt; │       ├── initial.meta</span></span>
<span><span class="co">#&gt; │       ├── intermediate_in_use.meta</span></span>
<span><span class="co">#&gt; │       ├── raw_in_use.meta</span></span>
<span><span class="co">#&gt; │       └── starting.meta</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">s03_pca</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── s03_pca.pdf</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s03_pca_files</span></span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">figure-latex</span></span></span>
<span><span class="co">#&gt; │               └── <span style="color: #BB00BB; font-weight: bold;">pca_plot-1.png</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">initial</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       ├── README.md</span></span>
<span><span class="co">#&gt; │   │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │           ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   │           └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">starting</span></span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │           ├── README.md</span></span>
<span><span class="co">#&gt; │           ├── <span style="color: #0000BB; font-weight: bold;">original</span></span></span>
<span><span class="co">#&gt; │           │   └── tux_measurements.csv</span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │               ├── palmer_penguins.csv</span></span>
<span><span class="co">#&gt; │               └── renv_s01_download_penguins.json</span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>We can see that both <code>data/raw</code> and
<code>data/intermediate</code> have been moved into
<code>versions</code>, <code>intermediate</code> is under the
<code>initial</code> version, while <code>raw</code> is under the
<code>starting</code> directory. In this vignette, we will be focusing
only on versioning <code>data/intermediate</code>. Advanced users can
also version <code>data/raw</code> (see the end of this vignette). For
now, <code>raw_in_use.meta</code> will point to the starting version of
<code>data/raw</code> and will not change.</p>
<p><code>data/intermediate</code> and <code>data/raw</code> have now
become links, which is why they are highlighted in a different colour
(light purple) in the tree above. We can use these links as if they were
directories, and check that they point correctly to the directories in
<code>versions</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/data/raw"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "original"              "README.md"             "s01_download_penguins"</span></span></code></pre></div>
<p>However, note that the data are now NOT being tracked by git, as
<code>versions</code> is in .gitignore. So, you want to make sure that
you have a reliable way to back up your data.</p>
</div>
<div class="section level2">
<h2 id="adding-a-new-version">Adding a new version<a class="anchor" aria-label="anchor" href="#adding-a-new-version"></a>
</h2>
<p>We might now want to revise the filtering of data that we are doing.
This will affect some intermediate data and results. Whilst results are
tracked in the git repository, data are not. However, we might want to
compare the results of the alternative filtering approaches. We can use
the <code><a href="../reference/version_add.html">version_add()</a></code> function to create a new version of the
data, which we can modify and compare to the <code>initial</code>
version we created earlier. It will also create a new branch in the git
repository (with the same name as the data version):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/version_add.html">version_add</a></span><span class="op">(</span></span>
<span>  intermediate_new_version <span class="op">=</span> <span class="st">"new_filtering"</span>,</span>
<span>  intermediate_description <span class="op">=</span> <span class="st">"Filtering out some data"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; version new_filtering created</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We have called our new version <code>new_filtering</code>, and we can
now see that we have switched to a new branch in the git repository
called <code>new_filtering</code>, as indicated by (HEAD) below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">git2r</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/git2r/reference/branches.html" class="external-link">branches</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $main</span></span>
<span><span class="co">#&gt; [b6b841] (Local) main</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $new_filtering</span></span>
<span><span class="co">#&gt; [c19ffd] (Local) (HEAD) new_filtering</span></span></code></pre></div>
<p>Now <code>data/raw</code> and <code>data/intermediate</code> are
symlinks to the <code>new_filtering</code> version of the data, which is
found under <code>versions/new_filtering</code>. Each version will be
under a new branch of the repository.</p>
<p>It is also in theory possible to version <code>data/raw</code> by
adding “raw_new_version” to the <code>version_add</code> function, but
this is NOT RECOMMENDED, as raw data should ideally not be changed (it
is supposed to represent the data in their original format).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s01_download_penguins.Rmd</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s02_merge_clean.Rmd</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #00BB00;">s03_pca.Rmd</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">version_meta</span></span></span>
<span><span class="co">#&gt; │       ├── initial.meta</span></span>
<span><span class="co">#&gt; │       ├── intermediate_in_use.meta</span></span>
<span><span class="co">#&gt; │       ├── new_filtering.meta</span></span>
<span><span class="co">#&gt; │       ├── raw_in_use.meta</span></span>
<span><span class="co">#&gt; │       └── starting.meta</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">s03_pca</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── s03_pca.pdf</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s03_pca_files</span></span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">figure-latex</span></span></span>
<span><span class="co">#&gt; │               └── <span style="color: #BB00BB; font-weight: bold;">pca_plot-1.png</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">initial</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       ├── README.md</span></span>
<span><span class="co">#&gt; │   │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │           ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   │           └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">new_filtering</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       ├── README.md</span></span>
<span><span class="co">#&gt; │   │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │           ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   │           └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">starting</span></span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │           ├── README.md</span></span>
<span><span class="co">#&gt; │           ├── <span style="color: #0000BB; font-weight: bold;">original</span></span></span>
<span><span class="co">#&gt; │           │   └── tux_measurements.csv</span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │               ├── palmer_penguins.csv</span></span>
<span><span class="co">#&gt; │               └── renv_s01_download_penguins.json</span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>Imagine that we have just been told that the first 10 measurements of
the penguins might be considered unreliable, as the scales were showing
a low battery warning. We now will edit the code that merges and cleans
the data, and modify it to remove the first 10 penguins from the
dataset. We use a pre-prepared script for this, which we copy to the
<code>code</code> directory:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/new_filtering/s02_merge_clean.Rmd"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"code/s02_merge_clean.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>If this was a “real” project, since the <code>new_filtering</code>
version is a new branch of the repository, we could edit the script in
the <code>code</code> directory and commit the changes.</p>
<p>We can now remove the full version of the intermediate dataset in the
<code>new_filtering</code> folder so that we can replace it with a new
version that excludes the first 10 penguins.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"data/intermediate/s02_merge_clean"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>penguins_na_omit.csv</code> is still in the
<code>versions/initial</code> folder, as we have not removed it from
<code>versions/initial</code> but only from the
<code>versions/new_filtering</code> directory.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s01_download_penguins.Rmd</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s02_merge_clean.Rmd</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #00BB00;">s03_pca.Rmd</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">version_meta</span></span></span>
<span><span class="co">#&gt; │       ├── initial.meta</span></span>
<span><span class="co">#&gt; │       ├── intermediate_in_use.meta</span></span>
<span><span class="co">#&gt; │       ├── new_filtering.meta</span></span>
<span><span class="co">#&gt; │       ├── raw_in_use.meta</span></span>
<span><span class="co">#&gt; │       └── starting.meta</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">s03_pca</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── s03_pca.pdf</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s03_pca_files</span></span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">figure-latex</span></span></span>
<span><span class="co">#&gt; │               └── <span style="color: #BB00BB; font-weight: bold;">pca_plot-1.png</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">initial</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       ├── README.md</span></span>
<span><span class="co">#&gt; │   │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │           ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   │           └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">new_filtering</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       └── README.md</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">starting</span></span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │           ├── README.md</span></span>
<span><span class="co">#&gt; │           ├── <span style="color: #0000BB; font-weight: bold;">original</span></span></span>
<span><span class="co">#&gt; │           │   └── tux_measurements.csv</span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │               ├── palmer_penguins.csv</span></span>
<span><span class="co">#&gt; │               └── renv_s01_download_penguins.json</span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>If we now knit the new version of the code, where we remove the first
10 penguins, the data are written to the
<code>versions/new_filtering/intermediate</code> directory.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s02_merge_clean.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s02_merge_clean.Rmd</span></span>
<span><span class="co">#&gt; output file: s02_merge_clean.knit.md</span></span>
<span><span class="co">#&gt; /opt/hostedtoolcache/pandoc/3.1.11/x64/pandoc +RTS -K512m -RTS s02_merge_clean.knit.md --to latex --from markdown+autolink_bare_uris+tex_math_single_backslash --output s02_merge_clean.tex --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/latex-div.lua --embed-resources --standalone --highlight-style tango --pdf-engine pdflatex --variable graphics --variable 'geometry:margin=1in'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s01_download_penguins.Rmd</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s02_merge_clean.Rmd</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #00BB00;">s03_pca.Rmd</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">version_meta</span></span></span>
<span><span class="co">#&gt; │       ├── initial.meta</span></span>
<span><span class="co">#&gt; │       ├── intermediate_in_use.meta</span></span>
<span><span class="co">#&gt; │       ├── new_filtering.meta</span></span>
<span><span class="co">#&gt; │       ├── raw_in_use.meta</span></span>
<span><span class="co">#&gt; │       └── starting.meta</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">s03_pca</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── s03_pca.pdf</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s03_pca_files</span></span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">figure-latex</span></span></span>
<span><span class="co">#&gt; │               └── <span style="color: #BB00BB; font-weight: bold;">pca_plot-1.png</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">initial</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       ├── README.md</span></span>
<span><span class="co">#&gt; │   │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │           ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   │           └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">new_filtering</span></span></span>
<span><span class="co">#&gt; │   │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   │       ├── README.md</span></span>
<span><span class="co">#&gt; │   │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt; │   │           └── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">starting</span></span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │           ├── README.md</span></span>
<span><span class="co">#&gt; │           ├── <span style="color: #0000BB; font-weight: bold;">original</span></span></span>
<span><span class="co">#&gt; │           │   └── tux_measurements.csv</span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │               ├── palmer_penguins.csv</span></span>
<span><span class="co">#&gt; │               └── renv_s01_download_penguins.json</span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>We can now compare the datasets of our two versions, and we can see
that our current version of the data, which is found in
<code>new_filtering</code>, has 10 fewer penguins than the
<code>initial</code> version.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins_new_filtering</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/intermediate/s02_merge_clean/penguins_na_omit.csv"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span></span>
<span>  <span class="st">"/versions/initial/intermediate/s02_merge_clean/penguins_na_omit.csv"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">penguins_initial</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 377</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">penguins_new_filtering</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 367</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merging-back-into-main">Merging back into main<a class="anchor" aria-label="anchor" href="#merging-back-into-main"></a>
</h2>
<p>If we are happy with the new version, we can merge it back into the
main branch. This will mean that our branch <code>main</code> will now
use the new version of the data (with the 10 less penguins). At the same
time, this means that we will replace the previous code with the code in
the new branch. You may want to keep both versions of the code if you
are interested in using both versions of the data. If we are absolutely
sure about merging back into the main branch, before doing it, we need
to commit the changes to the branch <code>new_filtering</code>.</p>
<p>How to commit in RStudio:</p>
<div style="text-align: center; margin-top: 10px; margin-bottom: 10px;">
<p><img src="img/git_commit.gif" alt="Committing in RStudio" style="max-width: 100%; height: auto; border: 1px solid #ccc; box-shadow: 2px 2px 5px rgba(0,0,0,0.1);"></p>
</div>
<p>Now we can merge the branch <code>new_filtering</code> into the
branch <code>main</code>, and check out <code>main</code>. To to this,
we can use the GitHub interface, following the steps below.</p>
<p>First, we need to push both branches to GitHub:</p>
<div style="text-align: center; margin-top: 10px; margin-bottom: 10px;">
<p><img src="img/git_push.gif" alt="Pushing to GitHub in RStudio" style="max-width: 100%; height: auto; border: 1px solid #ccc; box-shadow: 2px 2px 5px rgba(0,0,0,0.1);"></p>
</div>
<p>Now go to your repository page on GitHub. Click the “Pull requests”
tab. Then click the “New pull request” button and select base branch
(e.g., <code>main</code>) and compare branch (e.g.,
<code>new_filtering</code>). Click “Create pull request”, and add a
description. Click “Merge pull request” to complete the merge. Now you
can delete the <code>new_filtering</code> branch.</p>
<div style="text-align: center; margin-top: 10px; margin-bottom: 10px;">
<p><img src="img/resrepo_github_merge.gif" alt="Merging branches on GitHub" style="max-width: 100%; height: auto; border: 1px solid #ccc; box-shadow: 2px 2px 5px rgba(0,0,0,0.1);"></p>
</div>
<p>And now we have successfully versioned and updated our
repository.</p>
</div>
<div class="section level2">
<h2 id="outsourcing-the-data">Outsourcing the data<a class="anchor" aria-label="anchor" href="#outsourcing-the-data"></a>
</h2>
<p>Often, data are too big to be stored within your git repository.
Therefore, we may want to store them into a different location: locally
within your machine, in a hard drive, or to a folder synced to the
cloud. In this section, we will show how to use the
<code>version_setup</code> function to outsource your data.</p>
<p>Be aware that we can use the <code>version_setup</code> function only
once when initializing a repository. Therefore, we need to create an
empty repository for this example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/init_resrepo.html">init_resrepo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We now need to create a folder for data storage in our desired
external location.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">external_data_storage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"external_data_storage"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">external_data_storage</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">external_data_storage</span><span class="op">)</span></span></code></pre></div>
<p>For the purpose of this vignette, the above folder is created in a
temporary location. For your project this could be a directory in your
local machine, on a hard drive, or a folder synced to the cloud.</p>
<p>Now we have an empty folder where we want to store our data, and an
empty repository for our project.</p>
<p>This time to set up versioning with external data storage, we will
again use the function <code>version_setup</code>, however, we will set
the argument <code>resources_path</code> to the external path where we
would like to store the new versions of our data.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/version_setup.html">version_setup</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span>, resources_path <span class="op">=</span> <span class="va">external_data_storage</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We can now check that the repository has been set up correctly and we
see that <code>external_data_storage</code> is not found in the tree of
our repository:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">version_meta</span></span></span>
<span><span class="co">#&gt; │       ├── initial.meta</span></span>
<span><span class="co">#&gt; │       ├── intermediate_in_use.meta</span></span>
<span><span class="co">#&gt; │       ├── raw_in_use.meta</span></span>
<span><span class="co">#&gt; │       └── starting.meta</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   └── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #00BBBB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>However, the <code>data/raw</code> and <code>data/intermediate</code>
directories are now symlinks to the <code>external_data_storage</code>
folder, which is where the versions of our data will be stored.</p>
<p>We can see the structure of our external data storage folder looks
like this:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="st">"../../external_data_storage"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">../../external_data_storage</span></span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt;     ├── <span style="color: #0000BB; font-weight: bold;">initial</span></span></span>
<span><span class="co">#&gt;     │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt;     │       └── README.md</span></span>
<span><span class="co">#&gt;     └── <span style="color: #0000BB; font-weight: bold;">starting</span></span></span>
<span><span class="co">#&gt;         └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt;             ├── README.md</span></span>
<span><span class="co">#&gt;             └── <span style="color: #0000BB; font-weight: bold;">original</span></span></span></code></pre></div>
<p>We can now populate our repository with the necessary scripts.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/s01_download_penguins.Rmd"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s01_download_penguins.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/s02_merge_clean.Rmd"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s02_merge_clean.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/s03_pca.Rmd"</span>, package <span class="op">=</span> <span class="st">"resrepo"</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s03_pca.Rmd"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>And add our data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vignette_example/tux_measurements.csv"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"resrepo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/data/raw/original/tux_measurements.csv"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We can now run our scripts:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s01_download_penguins.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s01_download_penguins.Rmd</span></span>
<span><span class="co">#&gt; output file: s01_download_penguins.knit.md</span></span>
<span><span class="co">#&gt; /opt/hostedtoolcache/pandoc/3.1.11/x64/pandoc +RTS -K512m -RTS s01_download_penguins.knit.md --to latex --from markdown+autolink_bare_uris+tex_math_single_backslash --output s01_download_penguins.tex --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/latex-div.lua --embed-resources --standalone --highlight-style tango --pdf-engine pdflatex --variable graphics --variable 'geometry:margin=1in'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s02_merge_clean.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s02_merge_clean.Rmd</span></span>
<span><span class="co">#&gt; output file: s02_merge_clean.knit.md</span></span>
<span><span class="co">#&gt; /opt/hostedtoolcache/pandoc/3.1.11/x64/pandoc +RTS -K512m -RTS s02_merge_clean.knit.md --to latex --from markdown+autolink_bare_uris+tex_math_single_backslash --output s02_merge_clean.tex --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/latex-div.lua --embed-resources --standalone --highlight-style tango --pdf-engine pdflatex --variable graphics --variable 'geometry:margin=1in'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/knit_to_results.html">knit_to_results</a></span><span class="op">(</span><span class="fu"><a href="../reference/path_resrepo.html">path_resrepo</a></span><span class="op">(</span><span class="st">"/code/s03_pca.Rmd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; processing file: s03_pca.Rmd</span></span>
<span><span class="co">#&gt; output file: s03_pca.knit.md</span></span>
<span><span class="co">#&gt; /opt/hostedtoolcache/pandoc/3.1.11/x64/pandoc +RTS -K512m -RTS s03_pca.knit.md --to latex --from markdown+autolink_bare_uris+tex_math_single_backslash --output s03_pca.tex --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/latex-div.lua --embed-resources --standalone --highlight-style tango --pdf-engine pdflatex --variable graphics --variable 'geometry:margin=1in'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output created: s03_pca.pdf</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>When we view the git repository we can now see all our results
files:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">.</span></span></span>
<span><span class="co">#&gt; ├── README.md</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">code</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s01_download_penguins.Rmd</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BB00;">s02_merge_clean.Rmd</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #00BB00;">s03_pca.Rmd</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">data</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #00BBBB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">version_meta</span></span></span>
<span><span class="co">#&gt; │       ├── initial.meta</span></span>
<span><span class="co">#&gt; │       ├── intermediate_in_use.meta</span></span>
<span><span class="co">#&gt; │       ├── raw_in_use.meta</span></span>
<span><span class="co">#&gt; │       └── starting.meta</span></span>
<span><span class="co">#&gt; ├── <span style="color: #0000BB; font-weight: bold;">results</span></span></span>
<span><span class="co">#&gt; │   ├── README.md</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s01_download_penguins.pdf</span></span>
<span><span class="co">#&gt; │   ├── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt; │   │   ├── README.md</span></span>
<span><span class="co">#&gt; │   │   └── s02_merge_clean.pdf</span></span>
<span><span class="co">#&gt; │   └── <span style="color: #0000BB; font-weight: bold;">s03_pca</span></span></span>
<span><span class="co">#&gt; │       ├── README.md</span></span>
<span><span class="co">#&gt; │       ├── s03_pca.pdf</span></span>
<span><span class="co">#&gt; │       └── <span style="color: #0000BB; font-weight: bold;">s03_pca_files</span></span></span>
<span><span class="co">#&gt; │           └── <span style="color: #0000BB; font-weight: bold;">figure-latex</span></span></span>
<span><span class="co">#&gt; │               └── <span style="color: #BB00BB; font-weight: bold;">pca_plot-1.png</span></span></span>
<span><span class="co">#&gt; ├── <span style="color: #00BBBB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">writing</span></span></span>
<span><span class="co">#&gt;     └── README.md</span></span></code></pre></div>
<p>And the data are successfully stored in our external folder:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="st">"../../external_data_storage"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">../../external_data_storage</span></span></span>
<span><span class="co">#&gt; └── <span style="color: #0000BB; font-weight: bold;">versions</span></span></span>
<span><span class="co">#&gt;     ├── <span style="color: #0000BB; font-weight: bold;">initial</span></span></span>
<span><span class="co">#&gt;     │   └── <span style="color: #0000BB; font-weight: bold;">intermediate</span></span></span>
<span><span class="co">#&gt;     │       ├── README.md</span></span>
<span><span class="co">#&gt;     │       └── <span style="color: #0000BB; font-weight: bold;">s02_merge_clean</span></span></span>
<span><span class="co">#&gt;     │           ├── penguins_na_omit.csv</span></span>
<span><span class="co">#&gt;     │           ├── renv_s02_merge_clean.json</span></span>
<span><span class="co">#&gt;     │           └── renv_s03_pca.json</span></span>
<span><span class="co">#&gt;     └── <span style="color: #0000BB; font-weight: bold;">starting</span></span></span>
<span><span class="co">#&gt;         └── <span style="color: #0000BB; font-weight: bold;">raw</span></span></span>
<span><span class="co">#&gt;             ├── README.md</span></span>
<span><span class="co">#&gt;             ├── <span style="color: #0000BB; font-weight: bold;">original</span></span></span>
<span><span class="co">#&gt;             │   └── tux_measurements.csv</span></span>
<span><span class="co">#&gt;             └── <span style="color: #0000BB; font-weight: bold;">s01_download_penguins</span></span></span>
<span><span class="co">#&gt;                 ├── palmer_penguins.csv</span></span>
<span><span class="co">#&gt;                 └── renv_s01_download_penguins.json</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrea Manica.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
